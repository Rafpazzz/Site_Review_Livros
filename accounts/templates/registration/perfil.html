{% load static %}
<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meu Perfil</title>
    <link rel="stylesheet" href="{% static 'accounts/css/perfil.css' %}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    
    {% if messages %}
    <div style="position: fixed; top: 80px; right: 20px; z-index: 2000;">
        {% for message in messages %}
            <div style="background: white; color: #333; padding: 15px 25px; margin-bottom: 10px; border-radius: 8px; border-left: 6px solid #2ecc71; box-shadow: 0 4px 15px rgba(0,0,0,0.2); animation: slideIn 0.5s ease-out;">
                <i class="fas fa-check-circle" style="color: #2ecc71; margin-right: 8px;"></i> {{ message }}
            </div>
        {% endfor %}
    </div>
    {% endif %}

    <nav class="navbar">
        <a href="{% url 'home' %}" class="navbar-brand">Review Livros</a>

        <div class="navbar-links">
            <a href="{% url 'search_book' %}" class="nav-item">üîç Buscar Livro</a>
            
            <form action="{% url 'logout' %}" method="post" style="display:inline;">
                {% csrf_token %}
                <button type="submit" class="nav-item btn-logout">Sair</button>
            </form>
        </div>
    </nav>

    <div class="profile-container">
        <div class="profile-header">
            <div style="width: 60px; height: 60px; background: #0083b0; color: white; border-radius: 50%; display: flex; justify-content: center; align-items: center; font-size: 1.5rem; margin: 0 auto 10px auto; font-weight: bold; border: 3px solid white; box-shadow: 0 4px 10px rgba(0,0,0,0.1);">
                {{ user.username|slice:":1"|upper }}
            </div>

            <h1>Meu Perfil</h1>
            <p><strong>Usu√°rio:</strong> {{ user.username }}</p>
            <p><strong>Email:</strong> {{ user.email }}</p>
        </div>

        <hr>

        <div class="my-reviews">
            <h2>Minhas Avalia√ß√µes ({{ reviews.count }})</h2>

            {% for review in reviews %}
                <div class="review-card">
                    <div class="review-header">
                        <h3>
                            <a href="{% url 'view_review' review.id %}" class="link-titulo">
                                üìñ {{ review.book.titulo }}
                            </a>
                        </h3>
                        <span class="stars">{{ review.rating }}/5 ‚≠ê</span>
                    </div>
                    
                    <div class="review-body">
                        <p>{{ review.review_text|truncatechars:100 }}</p> 
                    </div>
                    
                    <div class="review-footer">
                        <small>Data: {{ review.created_at|date:"d/m/Y" }}</small>
                        
                        <a href="{% url 'view_review' review.id %}" class="btn-ver-review">
                            Ver completa ‚Üí
                        </a>
                    </div>
                </div>

            {% empty %}
                <div class="no-reviews" style="text-align: center; padding: 20px;">
                    <p>Voc√™ ainda n√£o fez nenhuma avalia√ß√£o.</p>
                    <br>
                    <a href="{% url 'search_book' %}" class="btn-buscar">Buscar livros para avaliar</a>
                </div>
            {% endfor %} 
        </div>
    </div>

</body>
</html>